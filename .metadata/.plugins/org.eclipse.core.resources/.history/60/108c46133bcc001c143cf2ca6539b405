package com.chainsys.jdbc;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.sql.*;

public class ResultSetMetadata {

	public static void main(String args[]) 
	{
		selectColumnsRead();
	}

	public static void ResultSetMetaData() {
		try {
			Class.forName("oracle.jdbc.driver.OracleDriver");
			Connection con = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe", "system",
					"8122444543aA");

			PreparedStatement ps = con.prepareStatement("select * from emp");
			ResultSet rs = ps.executeQuery();
			ResultSetMetaData rsmd = rs.getMetaData();

			System.out.println("Total columns: " + rsmd.getColumnCount());
			System.out.println("Column Name of 1st column: " + rsmd.getColumnName(2));
			System.out.println("Column Type Name of 1st column: " + rsmd.getColumnTypeName(2));

			con.close();
		} catch (Exception e) {
			System.out.println(e);
		}
	}

	public static void ResultSetMetaDat() throws Exception {
		Class.forName("oracle.jdbc.driver.OracleDriver");
		Connection con = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe", "system", "8122444543aA");
		Statement stmt = con.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE, ResultSet.CONCUR_UPDATABLE);
		ResultSet rs = stmt.executeQuery("select * from emp765");

		// getting the record of 3rd row
		rs.absolute(2);
		System.out.println(rs.getString(1) + " " + rs.getString(2) + " " + rs.getString(3));

		con.close();
	}

	public static void fetchdatas() {
		try {
			Connection myCon = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe", "system",
					"8122444543aA");
			java.sql.Statement mystat = myCon.createStatement();
			ResultSet myRs = mystat.executeQuery("select * from employees");
			while (myRs.next()) {
				System.out.println(myRs.getString("last_name") + ", " + myRs.getString("first_name"));
			}
			myCon.close();
		} catch (Exception err) {
			err.printStackTrace();
		}
	}

	public static void InsertRecordsPressN() throws Exception {
		Class.forName("oracle.jdbc.driver.OracleDriver");
		Connection con = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe", "system", "8122444543aA");

		PreparedStatement ps = con.prepareStatement("insert into emp130 values(?,?,?)");

		BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

		do {
			System.out.println("enter id:");
			int id = Integer.parseInt(br.readLine());
			System.out.println("enter name:");
			String name = br.readLine();
			System.out.println("enter salary:");
			float salary = Float.parseFloat(br.readLine());

			ps.setInt(1, id);
			ps.setString(2, name);
			ps.setFloat(3, salary);
			int i = ps.executeUpdate();
			System.out.println(i + " records affected");

			System.out.println("Do you want to continue: y/n");
			String s = br.readLine();
			if (s.startsWith("n")) {
				break;
			}
		} while (true);

		con.close();
	}
	
	public static void selectColumnsRead()
	{
		final String QUERY = "SELECT EMAIL FROM Employees";
		// Open a connection
				try (Connection conn = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe", "system", "8122444543aA");
						Statement stmt = conn.createStatement();
						ResultSet rs = stmt.executeQuery(QUERY);) {
					// Extract data from result set
					while (rs.next()) {
						// Retrieve by column name

						System.out.println(", Last: " + rs.getString("EMAIL"));
					}
				} catch (SQLException e) {
					e.printStackTrace();
			}
	}
	public static void storedDatasInsert()
	{
	      try {
	          Class.forName("oracle.jdbc.driver.OracleDriver");
	          Connection myCon = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","system","8122444543aA");
	          PreparedStatement ps = myCon.prepareStatement("insert into FileTable values(?,?)");
	          ps.setInt(1, 1555501);
	        //  ps.setCharacterStream(2, fr,(int)f.length());
	          ps.setString(2, "omkytgsumar");
	          int i = ps.executeUpdate();
	          System.out.println(i + " " + "record affected");
	          myCon.close();
	      }catch(Exception err) {
	          err.printStackTrace();
	      }
	}
	
	
}
