package com.chainsys.jdbc;

import java.sql.*;

public class ResultSetMetadata {

		public static void main(String args[]) 
		{
			
		}
		
		public static void ResultSetMetaData()
		{
			try {
				Class.forName("oracle.jdbc.driver.OracleDriver");
				Connection con = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe", "system", "8122444543aA");

				PreparedStatement ps = con.prepareStatement("select * from emp");
				ResultSet rs = ps.executeQuery();
				ResultSetMetaData rsmd = rs.getMetaData();

				System.out.println("Total columns: " + rsmd.getColumnCount());
				System.out.println("Column Name of 1st column: " + rsmd.getColumnName(2));
				System.out.println("Column Type Name of 1st column: " + rsmd.getColumnTypeName(2));

				con.close();
			} catch (Exception e) {
				System.out.println(e);
			}
		}
		
		public static void ResultSetMetaDat() throws Exception
		{
			Class.forName("oracle.jdbc.driver.OracleDriver");
			Connection con = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe", "system", "8122444543aA");
			Statement stmt = con.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE, ResultSet.CONCUR_UPDATABLE);
			ResultSet rs = stmt.executeQuery("select * from emp765");

	//getting the record of 3rd row  
			rs.absolute(2);
			System.out.println(rs.getString(1) + " " + rs.getString(2) + " " + rs.getString(3));

			con.close();
		}
		
		public static void fetchdatas()
		{
			try {
				Connection myCon = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe", "system", "8122444543aA");
				java.sql.Statement mystat = myCon.createStatement();
				ResultSet myRs = mystat.executeQuery("select * from employees");
				while (myRs.next()) {
					System.out.println(myRs.getString("last_name") + ", " + myRs.getString("first_name"));
				}
				myCon.close();
			} catch (Exception err) {
				err.printStackTrace();
			}}}


